<!DOCTYPE html>
<html>
	<head>
		<title>Orders Page - Website Name</title>
		<link rel="stylesheet" href="/stylesheets/table.css" />
		<link rel="stylesheet" href="/stylesheets/navbar.css" />

		<%- include('../partials/imports') %>
	</head>
	<body style="background-color: #e4e9f7">
		<%- include('../partials/navbar') %>
		<div class="modal fade" id="addProductsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="modal-title">Line Items</h5>
					<button type="button" class="btn-close" style="background-color: #1d1b31; color: white" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form class="needs-validation" action="/admin/addProduct" method="post" enctype="multipart/form-data" novalidate>
						<div class="row">
							<table
							id="modal-table"
							class="table table-hover responsive nowrap"
							style="width: 100%"
						>
							<thead>
								<tr style="background-color: #1d1b31; color: white">
									<th>Product  Name</th>
									<th>Price</th>
									<th>Quantity</th>
									
								</tr>
							</thead>
							<tbody id="products-table">
								<% for( let index = 0; index < 1; index++ ) { %>

								<tr>
									<td>
										<a href="#">
											<div class="d-flex align-items-center">
												<div class="avatar avatar-blue mr-3">
													<img
														src="https://images.unsplash.com/photo-1530319067432-f2a729c03db5?ixid=MnwxMjA3fDB8MHxzZWFyY2h8Nnx8aXBob25lfGVufDB8fDB8fA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=60"
														alt="productImage"
														style="width: 100%; height: 100%"
														id="pimg-table"
														class="table-img"
													/>
												</div>

												<div class="" >
													<p
														class="font-weight-bold mb-0 pl-2"
														style="border-bottom: none"
													id="pname"
														>
														
														pname
												
													</p>
												</div>
											</div>
										</a>
									</td>
								<td id="pprice" ></td>	
								<td id="pqty" ></td>	
									
								
								</tr>
								
								<% } %>
							</tbody>
						</table>
						
							
							
							
						
						
							
							<div class="col-12 mb-3 d-flex gap-2 justify-content-end">
								<button type="button" class="btn" style="background-color: white; color: #1d1b31;border: 1px solid #1d1b31;" data-bs-dismiss="modal">Close</button>
							
							</div>
						</div>
					</form>
				</div>
				</div>
			</div>
			</div>

			<div class="modal fade" id="addDetailsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="modal-title">Add Product</h5>
						<button type="button" class="btn-close" style="background-color: #1d1b31; color: white" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<form class="needs-validation" action="/admin/addProduct" method="post" enctype="multipart/form-data" novalidate>
							<div class="row">
								<table
								id="modal-table"
								class="table table-hover responsive nowrap"
								style="width: 100%"
							>
								<thead>
									<tr style="background-color: #1d1b31; color: white">
										<th>Address</th>
										<th>Country</th>
										
									</tr>
								</thead>
								<tbody id="address-table">
									<% for( let index = 0; index < 1; index++ ) { %>
	
									<tr>
										<td>
											<a href="#">
												<div class="d-flex align-items-center">
													<div class="avatar avatar-blue mr-3">
														<img
															src="https://images.unsplash.com/photo-1530319067432-f2a729c03db5?ixid=MnwxMjA3fDB8MHxzZWFyY2h8Nnx8aXBob25lfGVufDB8fDB8fA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=60"
															alt="productImage"
															style="width: 100%; height: 100%"
															id="dimg-table"
															class="table-img"
														/>
													</div>
	
													<div class="" >
														<p
															class="font-weight-bold mb-0 pl-2"
															style="border-bottom: none"
														id="dname"
															>
															<!-- Ethan Black -->
														Product Name
													
														</p>
													</div>
												</div>
											</a>
										</td>
									<td id="dprice" ></td>	
										
									
									</tr>
									
									<% } %>
								</tbody>
							</table>
							
								
								
								
							
							
								
								<div class="col-12 mb-3 d-flex gap-2 justify-content-end">
									<button type="button" class="btn" style="background-color: white; color: #1d1b31;border: 1px solid #1d1b31;" data-bs-dismiss="modal">Close</button>
								
								</div>
							</div>
						</form>
					</div>
					</div>
				</div>
				</div>
		<section class="root-section">
			<h2 class="text">Orders</h2>
			<div class="container capsule">
				<div class="row py-1">
					<div class="col-12">
						
						<table
							id="example"
							class="table table-hover responsive nowrap"
							style="width: 100%"
						>
							<thead>
								<tr style="background-color: #1d1b31; color: white">
									<th>Customer Name</th><th>Status</th><th>Created at</th><th>Completed at</th><th>Line item(modal)</th><th>Order Total</th>
								</tr>
							</thead>
							<tbody>
								<% for( let index = 0; index <orders.length ; index++ ) { %>

								<tr>
									<td>
										<a href="#">
											<div class="d-flex align-items-center">
											

												<div class="">
													<p
														class="font-weight-bold mb-0 pl-2"
														style="border-bottom: none"
													>
														
														<%= orders[index].customerName %> 
													</p>
												</div>
											</div>
										</a>
									</td>
									<td>
										<div
											class="badge <%= orders[index].status === "completed"? "bg-success":orders[index].status === "pending"?"bg-warning":"bg-danger"%> status"
											id="status-button-<%= index%>"
										>
											<%= orders[index].status %> 
										</div>
									</td>
									<td><%=orders[index].createdAt.toDate().toString().split("GMT")[0].trim()%></td>
									<td>
										<% if (orders[index].completedAt) { %>
											<%=orders[index].completedAt.toDate().toString().split("GMT")[0].trim() %>
										<% } %>
										  </td>
									<td> <button type="button" style="background-color: #1d1b31; color: white" class="btn " data-bs-toggle="modal" data-bs-target="#addProductsModal" onClick="getOrderdetails(`<%=index%>`)" >
										Purchased Products 
									</button></td>
									<td>
										<%=  orders[index].line_items[0].price_data.currency %> 
										<%=  orders[index].orderTotal %>
										
									</td>
								</tr>
								
								<% } %>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</section>
		<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
		<script src="/javascripts/table.js"></script>
		<script src="/javascripts/orders-page.js"></script>
		<script src="/javascripts/form-validation-client.js"></script>
		<script src="/javascripts/forms.js"></script>

	</body>
</html>
